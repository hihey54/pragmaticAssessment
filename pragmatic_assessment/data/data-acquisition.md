Our evaluation considers five different datasets, all of which are publicly available. Specifically: CTU13, GTCS, UF-NB15, NB15, IDS17.

Here, we first discuss the structure of this folder, and explain the procedures to obtain all our source data for 100% reproducibility. 

# Folder Description

This folder contains 5 subfolders, each named after one of the five datasets considered in our paper.
Each of these subfolders has, in turn, a folder named "flows", which also has subfolder named "malicious".

The code for our main experiments (whose notebooks are in the "evaluation" section of this repository) expects that these folders (and subfolders) contain the "preprocessed" version of our considered datasets---which can be obtained by running the notebooks in the "preprocessing" section of this repository after downloading the source data files).

After such preprocessing, the "flow" folder of each dataset should contain:
* a single CSV file, "benign.csv", which includes _all the benign samples_ of the corresponding dataset;
* in the "malicious" subfolder, as many CSV files as the amount of *malicious classes* included in the corresponding dataset.


Moreover, in each dataset folder we provide the SHA256 of the "preprocessed data", which can be used to ensure that everything matches.

**IMPORTANT**: depending on the version of the libraries used to preprocess the data, the SHA256 can change. This is because some libraries truncate some values (e.g., "2.6000000000000002e-05" can become "2.6e-05"). The results are not impacted by such a change.

Finally, to kickstart some experiments, we include the "preprocessed" version (as a zipped file) of the GTCS dataset.
Upon request (contact giovanni.apruzzese@uni.li) we can provide access to the preprocessed version of all our considered datasets. 


# Obtaining the data from the source

## CTU13

The CTU13 dataset was captured at the CTU University in Prague. It contains annotated network data, in the form of both PCAP and NetFlow (generated via Argus). The malicious traffic was generated by infecting some machines with malware, and capturing their traffic in a controlled experiment. It is extensively described here: https://www.stratosphereips.org/datasets-ctu13. Below are bibliographic information on the corresponding paper.

```
@article{garcia2014empirical,
  title={An empirical comparison of botnet detection methods},
  author={Garcia, Sebastian and Grill, Martin and Stiborek, Jan and Zunino, Alejandro},
  journal={Computers \& Security},
  volume={45},
  pages={100--123},
  year={2014},
  publisher={Elsevier}
}
```

To obtain this dataset, we followed the links provided by its creators on the corresponding webpage. Specifically, the CTU13 is made up of 13 parts, each containing malicious traffic corresponding to a specific piece of malware. For instance, this is the URL that points to the second part (which is related to the _Neris_ botnet): https://mcfp.felk.cvut.cz/publicDatasets/CTU-Malware-Capture-Botnet-43/).

By following the link, we are brought to a repository containing multiple files and folders (all related to the corresponding part). For our experiments, we downloaded the "binetflow" file contained in the "detailed-bidirectional-flow-labels" folder. For instance, this is the file we considered as the second part of CTU13: https://mcfp.felk.cvut.cz/publicDatasets/CTU-Malware-Capture-Botnet-43/detailed-bidirectional-flow-labels/capture20110811.binetflow. Overall, these files weigh approximately 2.5GB (uncompressed).

After downloading all the 13 files making up the CTU13 dataset, we "relabel" them so that each sample is associated to a more "representative" label. Such a procedure is coded in the "prelabeling_ctu13.ipnyb" notebook.

(note: the "first" part of CTU13 had a broken link, so we did not consider this in our evaluation)


## GTCS

The GTCS (short for "Game Theory and Cyber Security") dataset was collected in 2020, and it contains labelled NetFlows generated via the original version of CIC-FlowMeter. It is extensively described in the following publication:

```
@article{mahfouz2020ensemble,
  title={Ensemble classifiers for network intrusion detection using a novel network attack dataset},
  author={Mahfouz, Ahmed and Abuhussein, Abdullah and Venugopal, Deepak and Shiva, Sajjan},
  journal={Future Internet},
  volume={12},
  number={11},
  pages={180},
  year={2020},
  publisher={MDPI}
}
```

It can be downloaded from here: https://www.researchgate.net/publication/344478320_GTCS_Network_Attack_Dataset (the archive is ~37MB, and 220MB uncompressed).

## IDS17

The IDS17 (short for "CIC-IDS17") dataset was created by the Canadian Institute for Cybersecurity, and is one of the most popular datasets for NetFlow-based Intrusion Detection Systems. Its original version is extensively described here: https://www.unb.ca/cic/datasets/ids-2017.html. The bibliographic entry of the corresponding research article is:

```
@article{sharafaldin2018toward,
  title={Toward generating a new intrusion detection dataset and intrusion traffic characterization.},
  author={Sharafaldin, Iman and Lashkari, Arash Habibi and Ghorbani, Ali A},
  journal={ICISSp},
  volume={1},
  pages={108--116},
  year={2018}
}
```

However, this dataset was _found to be flawed_ in 2021, in a work by Engelen et al. ([source](https://ieeexplore.ieee.org/abstract/document/9474286){target:blank}). We hence use the "fixed" version of this dataset, which can be obtained by following the procedure described by Engelen et al.: https://intrusion-detection.distrinet-research.be/WTMC2021/. We also provide the bibliographic information of this important work:

```
@inproceedings{engelen2021troubleshooting,
title={Troubleshooting an Intrusion Detection Dataset: the CICIDS2017 Case Study},
author={Engelen, Gints and Rimmer, Vera and Joosen, Wouter},
booktitle={2021 IEEE Security and Privacy Workshops (SPW)},
pages={7--12},
year={2021},
organization={IEEE}
}
```

After following all the procedures described above, we obtain a total of five CSV files containing labelled NetFlows (generated via the "fixed" version of CIC-FlowMeter), amounting to ~1GB of data.

## NB15

The NB15 (short for UNSW-NB15) dataset was created by the University of New South Wales, and is described at the following webpage: https://research.unsw.edu.au/projects/unsw-nb15-dataset (which also provides the download links). The bibliographic entry of the most relevant publication is:

```
@inproceedings{moustafa2015unsw,
  title={UNSW-NB15: a comprehensive data set for network intrusion detection systems (UNSW-NB15 network data set)},
  author={Moustafa, Nour and Slay, Jill},
  booktitle={2015 military communications and information systems conference (MilCIS)},
  pages={1--6},
  year={2015},
  organization={IEEE}
}
```

The NB15 consists of four CSV files, containing labelled NetFlows (generated by Bro -- former name of Zeek) amounting to ~560MB.


## UF-NB15

The UF-NB15 is a variant of the NB15 dataset (created by its very same authors) that was generated by using nProbe (instead of Bro) to export the same network traffic into NetFlows. The bibliographic entry of the corresponding publication is:

```
@inproceedings{sarhan2021netflow,
  title={Netflow datasets for machine learning-based network intrusion detection systems},
  author={Sarhan, Mohanad and Layeghy, Siamak and Moustafa, Nour and Portmann, Marius},
  booktitle={Big Data Technologies and Applications: 10th EAI International Conference, BDTA 2020, and 13th EAI International Conference on Wireless Internet, WiCON 2020, Virtual Event, December 11, 2020, Proceedings 10},
  pages={117--135},
  year={2021},
  organization={Springer}
}
```

The UF-NB15 can be obtained at the following link: https://staff.itee.uq.edu.au/marius/NIDS_datasets/#RA6. The dataset consists in a single CSV file of ~420MB (the compressed version is ~35MB), containing labelled NetFlows.